diff -crB prosody-0.3.0/util-src/Makefile prosody-0.3.0_modified/util-src/Makefile
*** prosody-0.3.0/util-src/Makefile	Mon Feb  2 18:05:21 2009
--- prosody-0.3.0_modified/util-src/Makefile	Sat Feb 14 00:29:28 2009
***************
*** 6,12 ****
  LUA_LIB?=lua$(LUA_SUFFIX)
  IDN_LIB?=idn
  OPENSSL_LIB?=crypto
! 
  
  
  all: encodings.so hashes.so pposix.so
--- 6,12 ----
  LUA_LIB?=lua$(LUA_SUFFIX)
  IDN_LIB?=idn
  OPENSSL_LIB?=crypto
! CC=gcc
  
  
  all: encodings.so hashes.so pposix.so
***************
*** 21,38 ****
  	rm -f ../util/*.so
  
  encodings.o: encodings.c
! 	gcc $(CFLAGS) -I$(LUA_INCDIR) -c -o encodings.o encodings.c
  encodings.so: encodings.o
! 	export MACOSX_DEPLOYMENT_TARGET="10.3"; gcc $(LFLAGS) -o encodings.so encodings.o -L/usr/local/lib -llua$(LUA_SUFFIX) -lidn
  	
  
  hashes.o: hashes.c
! 	gcc $(CFLAGS) -I$(LUA_INCDIR) -c -o hashes.o hashes.c
  hashes.so: hashes.o
! 	export MACOSX_DEPLOYMENT_TARGET="10.3"; gcc $(LFLAGS) -o hashes.so hashes.o -L/usr/local/lib -llua$(LUA_SUFFIX) -lcrypto
  
  pposix.o: pposix.c
! 	gcc $(CFLAGS) -I$(LUA_INCDIR) -c -o pposix.o pposix.c
  pposix.so: pposix.o
! 	export MACOSX_DEPLOYMENT_TARGET="10.3"; gcc $(LFLAGS) -o pposix.so pposix.o -L/usr/local/lib -llua$(LUA_SUFFIX)
  	
--- 21,38 ----
  	rm -f ../util/*.so
  
  encodings.o: encodings.c
! 	$(CC) $(CFLAGS) -I$(LUA_INCDIR) -c -o encodings.o encodings.c
  encodings.so: encodings.o
! 	export MACOSX_DEPLOYMENT_TARGET="10.3"; $(CC) $(LFLAGS) -o encodings.so encodings.o -L$(LUA_LIBDIR) -llua$(LUA_SUFFIX) -lidn
  	
  
  hashes.o: hashes.c
! 	$(CC) $(CFLAGS) -I$(LUA_INCDIR) -c -o hashes.o hashes.c
  hashes.so: hashes.o
! 	export MACOSX_DEPLOYMENT_TARGET="10.3"; $(CC) $(LFLAGS) -o hashes.so hashes.o -L$(LUA_LIBDIR) -llua$(LUA_SUFFIX) -lcrypto
  
  pposix.o: pposix.c
! 	$(CC) $(CFLAGS) -I$(LUA_INCDIR) -c -o pposix.o pposix.c
  pposix.so: pposix.o
! 	export MACOSX_DEPLOYMENT_TARGET="10.3"; $(CC) $(LFLAGS) -o pposix.so pposix.o -L$(LUA_LIBDIR) -llua$(LUA_SUFFIX)
  	
